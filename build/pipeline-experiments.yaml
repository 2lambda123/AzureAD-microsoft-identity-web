# ASP.NET Core
# Build and test ASP.NET Core projects targeting .NET Core.
# Add steps that run tests, create a NuGet package, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/dotnet-core
 
trigger: none
pr: none
 
# Create a daily midnight build for release builds on master to ensure our release builds function
schedules:
- cron: "0 0 * * *"
  displayName: Daily midnight build
  branches:
    include:
    - master
 
pool:
  name: MwWilson1EsHostedPool
  demands:
  - msbuild
  - visualstudio
  timeoutInMinutes: 360
 
variables:
  BuildPlatform: 'any cpu'
  BuildConfiguration: 'Release'
 
steps:
# Run pre-build code analysis (policheck, credscan, etc)
- template: template-prebuild-code-analysis.yaml
 
# Bootstrap the build
- template: template-install-dependencies.yaml
 
# Nuget Restore and Build Microsoft.Identity.Web.sln
- template: template-restore-build-MSIdentityWeb.yaml
  parameters:
    BuildPlatform: '$(BuildPlatform)'
    BuildConfiguration: '$(BuildConfiguration)'
    MsIdentityWebSemVer: $(MsIdentityWebSemVer)
 
# Run Post-build code analysis (e.g. Roslyn)
- template: template-postbuild-code-analysis.yaml
 
# Run the dotnet daemon app
- task: DotNetCoreCLI@2
  displayName: 'Build and run dotnet daemon app'
  inputs:
    command: run
    projects: 'tests\DevApps\daemon-app\Daemon-app\Daemon-app.csproj'
    arguments: '-f net7.0'

